### 1. Программа сообщает "Конфигурационный файл не найден" или "xxxxx требует конфигурации ключа API xxxxx." Как я могу это исправить?

Это распространенная проблема настройки. Есть несколько причин, по которым это может произойти:

1. **Неправильное местоположение или имя файла:**

* Программа требует конфигурационный файл с точно таким именем `config.toml`. Убедитесь, что вы случайно не назвали его `config.toml.txt`.
* Этот файл должен находиться внутри папки `config`. Правильная структура рабочей директории должна быть следующей:
  ```
  /── config/
  │   └── config.toml
  └── krillinai.exe(ваш исполняемый файл)
  ```
* **Для пользователей Windows:** Рекомендуется разместить всю директорию программного обеспечения в папке, которая не находится на диске C:, чтобы избежать потенциальных проблем с разрешениями.

2. **Неполная конфигурация ключа API:**

* Приложение требует отдельные конфигурации для большой языковой модели (для перевода), голосового сервиса (для транскрипции и синтеза речи) и сервиса tts.
* Даже если вы используете OpenAI для всего, вы должны заполнить ключ в разных разделах файла `config.toml`. Найдите раздел `llm`, раздел `transcribe`, раздел `tts` и заполните соответствующие ключи API и другую необходимую информацию.

### 2. Я получаю ошибку, содержащую "yt-dlp error." Что мне делать?

Эта ошибка указывает на проблему с загрузчиком видео, которая обычно связана с вашей сетью или версией загрузчика.

* **Сеть:** Если вы используете прокси, убедитесь, что он правильно настроен в настройках прокси в вашем файле `config.toml`.
* **Обновите `yt-dlp`:** Версия `yt-dlp`, поставляемая с программным обеспечением, может быть устаревшей. Вы можете обновить ее вручную, открыв терминал в директории `bin` программного обеспечения и выполнив команду:
  ```
  ./yt-dlp.exe -U
  ```
  
  (Замените `yt-dlp.exe` на правильное имя файла для вашей операционной системы, если оно отличается).

### 3. Субтитры в финальном видео искажены или выглядят как квадратные блоки, особенно на Linux.

Это почти всегда вызвано отсутствием шрифтов в системе, особенно тех, которые поддерживают китайские символы. Чтобы это исправить, вам нужно установить необходимые шрифты.

1. Скачайте необходимые шрифты, такие как [Microsoft YaHei](https://modelscope.cn/models/Maranello/KrillinAI_dependency_cn/resolve/master/%E5%AD%97%E4%BD%93/msyh.ttc) и [Microsoft YaHei Bold](https://modelscope.cn/models/Maranello/KrillinAI_dependency_cn/resolve/master/%E5%AD%97%E4%BD%93/msyhbd.ttc).
2. Создайте новую директорию шрифтов: `sudo mkdir -p /usr/share/fonts/msyh`.
3. Скопируйте загруженные файлы шрифтов `.ttc` в эту новую директорию.
4. Выполните следующие команды для пересоздания кэша шрифтов:
    ```
    cd /usr/share/fonts/msyh
    sudo mkfontscale
    sudo mkfontdir
    sudo fc-cache -fv
    ```

### 4. На macOS приложение не запускается и показывает ошибку "KrillinAI поврежден и не может быть открыт."

Это вызвано функцией безопасности macOS, Gatekeeper, которая ограничивает приложения от неопознанных разработчиков. Чтобы это исправить, вам нужно вручную удалить атрибут карантина.

1. Откройте приложение **Терминал**.
2. Введите команду `xattr -cr`, затем пробел, затем перетащите файл `KrillinAI.app` из вашего окна Finder в Терминал. Команда будет выглядеть примерно так:
    ```
    xattr -cr /Applications/KrillinAI.app
    ```
3. Нажмите Enter. Теперь вы должны иметь возможность открыть приложение.

### 5. Я получаю ошибки, такие как `ffmpeg error`, `audioToSrt error` или `exit status 1` во время обработки.

Эти ошибки обычно указывают на проблемы с зависимостями или системными ресурсами.

* **`ffmpeg error`:** Это указывает на то, что `ffmpeg` либо не установлен, либо недоступен из PATH системы. Убедитесь, что у вас установлена полная, официальная версия `ffmpeg` и что ее местоположение добавлено в переменные окружения вашей системы.
* **`audioToSrt error` или `exit status 1`:** Эта ошибка возникает на этапе транскрипции (аудио в текст). Общие причины:
  * **Проблемы с моделью:** Локальная модель транскрипции (например, `fasterwhisper`) не смогла загрузиться или была повреждена во время загрузки.
  * **Недостаточно памяти (ОЗУ):** Запуск локальных моделей требует много ресурсов. Если у вашего компьютера закончится память, операционная система может завершить процесс, что приведет к ошибке.
  * **Сбой сети:** Если вы используете онлайн-сервис транскрипции (например, Whisper API от OpenAI), это указывает на проблему с вашим сетевым подключением или недействительным ключом API.

### 6. Индикатор прогресса не движется. Программа зависла?

Нет, пока вы не видите сообщение об ошибке, программа работает. Индикатор прогресса обновляется только после завершения крупной задачи (например, транскрипции или кодирования видео). Эти задачи могут занимать много времени, что может привести к тому, что индикатор прогресса будет приостановлен на длительный период. Пожалуйста, будьте терпеливы и дождитесь завершения задачи.

### 7. Мой графический процессор NVIDIA 5000 серии не поддерживается `fasterwhisper`. Что мне делать?

Было замечено, что модель `fasterwhisper` может не работать корректно с графическими процессорами NVIDIA 5000 серии (по состоянию на середину 2025 года). У вас есть несколько альтернатив для транскрипции:

1. **Используйте облачную модель:** Установите `transcribe.provider.name` на `openai` или `aliyun` в вашем файле `config.toml`. Затем заполните соответствующий ключ API и детали конфигурации. Это будет использовать модель Whisper облачного провайдера вместо локальной.
2. **Используйте другую локальную модель:** Вы можете поэкспериментировать с другими локальными моделями транскрипции, такими как оригинальная `whisper.cpp`.

### 8. Как мне найти и заполнить правильный код голоса/тона для синтеза речи?

Доступные голоса и их соответствующие коды определяются провайдером голосового сервиса, который вы используете. Пожалуйста, обратитесь к их официальной документации.

* **OpenAI TTS:** [Документация](https://platform.openai.com/docs/guides/text-to-speech/api-reference) (см. параметры `voice`).
* **Alibaba Cloud:** [Документация](https://help.aliyun.com/zh/isi/developer-reference/overview-of-speech-synthesis) (см. параметр `voice` в списке тонов).

### 9. Как я могу использовать локальную большую языковую модель (LLM), такую как работающая на Ollama, для перевода?

Да, вы можете настроить KrillinAI для использования любой локальной LLM, которая предоставляет совместимый с OpenAI API конечный пункт.

1. **Запустите вашу локальную LLM:** Убедитесь, что ваш локальный сервис (например, Ollama, работающий на Llama3) активен и доступен.
2. **Отредактируйте `config.toml`:** В разделе для большой языковой модели (переводчика):

* Установите `provider name` (или `type`) на `"openai"`.
* Установите `api_key` на любую случайную строку (например, `"ollama"`), так как он не нужен для локальных вызовов.
* Установите `base_url` на конечный пункт API вашей локальной модели. Для Ollama это обычно `http://localhost:11434/v1`.
* Установите `model` на имя модели, которую вы обслуживаете, например, `"llama3"`.

### 10. Могу ли я настроить стиль субтитров (шрифт, размер, цвет) в финальном видео?

Нет. В настоящее время KrillinAI генерирует **жестко закодированные субтитры**, что означает, что они встраиваются непосредственно в кадры видео. Приложение **не предлагает опций для настройки стиля субтитров**; оно использует предустановленный стиль.

Для продвинутой настройки рекомендуется следующий обходной путь:

1. Используйте KrillinAI для генерации переведенного файла субтитров `.srt`.
2. Импортируйте ваше оригинальное видео и этот файл `.srt` в профессиональный видеоредактор (например, Premiere Pro, Final Cut Pro, DaVinci Resolve), чтобы применить пользовательские стили перед рендерингом.

### 11. У меня уже есть переведенный файл `.srt`. Может ли KrillinAI использовать его только для дубляжа?

Нет, эта функция в настоящее время не поддерживается. Приложение выполняет полный процесс от транскрипции до финальной генерации видео.